# 更新日志

## [v2.2.0] - 2025-01-19

### 🆕 新增功能

#### 1. 政务微信包名自定义配置
- 在主界面添加"政务微信包名"配置输入框
- 支持自定义配置政务微信的应用包名
- 默认值：`com.tencent.wework`（企业微信）
- 适配公安内网政务微信等不同版本
- 配置自动保存，无需重复输入

#### 2. 屏幕分辨率自适应
- 新增 `CoordinateScaler` 坐标缩放工具类
- 自动检测设备屏幕分辨率
- 所有点击坐标和OCR识别区域自动缩放
- 主界面显示当前设备分辨率信息
- 基准分辨率：1080x2340

### 🔧 改进优化

#### 点击和手势操作
- `performClick()` 方法支持自动坐标缩放
- `performLongClick()` 方法支持自动坐标缩放
- 所有点击操作根据屏幕分辨率自动调整

#### OCR识别优化
- `performOCR()` 方法支持自动区域缩放
- OCR识别区域根据屏幕分辨率自动调整
- 日志显示原始坐标和缩放后坐标，便于调试

#### 日志增强
- 启动时记录屏幕分辨率信息
- 启动时记录坐标缩放比例
- OCR识别时记录坐标转换信息
- 打开政务微信时记录使用的包名

### 📝 UI改进

- 民警选择下方添加政务微信包名配置区域
- 显示实时屏幕分辨率信息（宽x高 | 密度 | DPI）
- 改进布局，信息更清晰易读

### 📚 文档更新

- 更新 README.md，添加配置说明章节
- 新增"开发者配置"章节，说明如何调整基准分辨率
- 新增"配置说明.md"文档，详细说明两个问题的解决方案
- 添加调试技巧和快速检查清单

### 🐛 修复问题

#### 问题1：政务微信无法打开
**原因**：硬编码的包名 `com.tencent.wework` 不适用于公安内网政务微信  
**解决**：
- 添加包名配置功能，用户可自定义
- 在所有启动政务微信的地方使用配置的包名
- 包名自动保存到SharedPreferences

#### 问题2：OCR识别位置不准确
**原因**：硬编码的坐标不适配不同分辨率设备  
**解决**：
- 实现自动坐标缩放机制
- 根据设备分辨率与基准分辨率的比例自动调整
- 支持开发者自定义基准分辨率

### 🔄 代码结构变化

#### 新增文件
- `CoordinateScaler.kt` - 坐标缩放工具类

#### 修改文件
- `MainActivity.kt` - 添加包名配置和屏幕信息显示
- `YunDuanBanAccessibilityService.kt` - 集成坐标缩放功能
- `activity_main.xml` - 添加UI控件
- `strings.xml` - 添加相关字符串资源
- `README.md` - 更新文档

#### 新增文档
- `配置说明.md` - 详细的配置和故障排除指南

### ⚙️ 技术细节

#### 坐标缩放算法
```kotlin
scaleX = currentWidth / BASE_WIDTH
scaleY = currentHeight / BASE_HEIGHT
scaledX = originalX * scaleX
scaledY = originalY * scaleY
```

#### 支持的分辨率范围
- 理论上支持所有Android设备分辨率
- 自动计算缩放比例
- 建议基准分辨率接近常用设备（1080x2340）

### 📱 兼容性

- Android 10+ (API 29+)
- 已测试设备分辨率：1080x2340（基准）
- 其他分辨率通过自动缩放适配

### 🎯 下一步计划

- [ ] 添加OCR识别区域可视化调试工具
- [ ] 支持多套坐标预设（针对不同分辨率）
- [ ] 添加坐标微调界面（GUI配置）
- [ ] 支持更多政务微信版本预设

---

## [v2.1.0] - 之前版本

- 初始版本
- 基础自动化功能
- OCR识别
- 民警管理
- 日志功能

---

**维护者**: 新质战斗力未来中心  
**最后更新**: 2025-01-19
